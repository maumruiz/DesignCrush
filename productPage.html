<!DOCTYPE html>
<html>
<head>
    <title>Cart</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/homeStyles.css" />
    <script src="js/jquery-1.11.3.min.js" type="text/javascript"></script>
    <script src="js/bootstrap.min.js"></script>
</head>
<body>
    <header>
    <!-- Navigation bar -->
    <nav class="navbar navbar-inverse navbar-static-top" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navegacion">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a href="home.html" class="navbar-brand">Diseñazo</a>
            </div>

            <!-- Inicia Menu -->
            <div class="collapse navbar-collapse" id="navegacion">
                <!-- Botones de barra de navegación derecha -->
                <ul id="navRightButtons" class="nav navbar-nav navbar-right">
                    <!-- Login / Register Button -->

                    <!-- User dropdown -->

                    <!-- Shopping Cart -->

                </ul>
                <!-- Search bar -->
                <form action="" class="navbar-form navbar-right" role="search">
                    <div class="form-group">
                        <input id="searchBar" type="text" class="form-control" placeholder="Search">
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <span class="glyphicon glyphicon-search"></span>
                    </button>
                </form> <!-- Search bar -->
            </div> <!-- navbar -->
        </div> <!-- Container -->
    </nav>
    </header>

    <!-- Page Content -->
    <div class="container">

        <!-- Breadcumbs -->
        <div class="row">
            <div class="col-lg-12">
                <h1 class="page-header">Product
                    <small>Select</small>
                </h1>
                <ol class="breadcrumb">
                    <li><a href="home.html">Home</a></li>
                    <li><a href="designPage.html">Design</a></li>
                    <li class="active">Product</li>
                </ol>
            </div> <!-- col-lg-12 -->
        </div> <!-- breadcrumbs Row -->

        <!-- Product Row -->
        <div class="row">
            <div class="col-md-6">
                <div id="productImage">

                </div>
            </div>

            <div class="col-md-6">
                <div id="productInfo">
                <div class="row">
                    <div class="col-lg-12">
                        <h2 id="buyHeader" class="page-header"></h2>
                    </div>
                </div>
                <div class="row">
                    <form class="form-horizontal" role="form">
                    <div class="form-group">
                      <label class="col-sm-3 control-label">Type: </label>
                      <div class="col-sm-9">
                        <p id="productTypeText" class="form-control-static"><strong></strong></p>
                      </div>
                    </div>
                    <div id="sizeProduct-group" class="form-group">
                        <label class="control-label col-sm-3" for="size">Size:</label>
                        <div class="col-sm-9">
                            <select id="sizeProduct" class="form-control">
                                <option>XS</option>
                                <option>S</option>
                                <option>M</option>
                                <option>L</option>
                                <option>XL</option>
                            </select>
                        </div>
                    </div>
                    <div id="colorProduct-group" class="form-group">
                        <label class="control-label col-sm-3" for="color">Color:</label>
                        <div class="col-sm-9">
                            <label class="radio-inline">
                                <input type="radio" name="colorProduct" value="red"> <div class="productColor" style="    background-color: red"> </div>
                            </label>
                            <label class="radio-inline">
                                <input type="radio" name="colorProduct" value="blue"> <div class="productColor" style="    background-color: midnightBlue"> </div>
                            </label>
                            <label class="radio-inline">
                                <input type="radio" name="colorProduct" value="green"> <div class="productColor" style="    background-color: green"> </div>
                            </label>
                            <label class="radio-inline">
                                <input type="radio" name="colorProduct" value="black"> <div class="productColor" style="    background-color: black"> </div>
                            </label>
                            <label class="radio-inline">
                                <input type="radio" name="colorProduct" value="grey"> <div class="productColor" style="    background-color: grey"> </div>
                            </label>
                            <label class="radio-inline">
                                <input type="radio" name="colorProduct" value="white"> <div class="productColor" style="    background-color: white"> </div>
                            </label>
                        </div>
                    </div>
                    <div id="quantityProduct-group" class="form-group">
                        <label for="quantity" class="col-sm-3 control-label">Quantity:</label>
                        <div class="col-sm-9">
                            <input type="number" value=1 class="form-control" id="quantityProduct" placeholder="Quantity">
                        </div>
                    </div>
                    <div class="form-group">
                      <label class="col-sm-3 control-label">Unit Price:</label>
                      <div class="col-sm-9">
                        <p id="unitPriceText" class="form-control-static"><strong></strong></p>
                      </div>
                    </div>
                    <hr>
                    <div class="form-group">
                        <div class="col-sm-10">
                            <button id="addToCartButton" type="button" class="btn btn-success btn-lg pull-right">Add to Cart</button>
                        </div>
                    </div>
                    </form> <!-- Product form -->
                </div> <!-- Form row -->
                </div> <!-- productInfo div -->
            </div> <!-- Product select column -->
        </div> <!-- Design row -->

        <!-- nav tab row (Products, Comments, Related) -->
        <div class="row">

            <div class="col-md-6">
            <div class="panel with-nav-tabs panel-info">
                <div class="panel-heading">
                        <ul class="nav nav-tabs nav-justified">
                            <li class="active"><a href="#tab1info" data-toggle="tab">Products</a></li>
                            <li><a href="#tab2info" data-toggle="tab">Related</a></li>
                        </ul>
                </div> <!-- Panel Heading -->

                <div class="panel-body">
                    <div class="tab-content">
                        <div class="tab-pane fade in active" id="tab1info">
                            <!-- Clothing Row -->
                            <div class="row">
                                <div class="col-lg-12">
                                    <h3 class="page-header">Clothing</h3>
                                </div>

                                <div class="col-sm-6 col-xs-6">
                                    <a href="productPage.html">
                                        <img class="img-responsive img-hover img-product" src="img/products/tshirt.png" alt="t-shirt">
                                    </a>
                                </div>
                                <div class="col-sm-6 col-xs-6">
                                    <a href="productPage.html">
                                        <img class="img-responsive img-hover img-product" src="img/products/vneck.png" alt="v-neck">
                                    </a>
                                </div>
                                <div class="col-sm-6 col-xs-6">
                                    <a href="productPage.html">
                                        <img class="img-responsive img-hover img-product" src="img/products/longsleeve.png" alt="long sleeve">
                                    </a>
                                </div>
                                <div class="col-sm-6 col-xs-6">
                                    <a href="productPage.html">
                                        <img class="img-responsive img-hover img-product" src="img/products/hoodie.png" alt="hoodie">
                                    </a>
                                </div>
                            </div> <!-- /.row -->

                            <!-- Wall-art Row -->
                            <div class="row">
                                <div class="col-lg-12">
                                    <h3 class="page-header">Wall-art</h3>
                                </div>

                                <div class="col-sm-6 col-xs-6">
                                    <a href="productPage.html">
                                        <img class="img-responsive img-hover img-product" src="img/products/poster.jpg" alt="poster">
                                    </a>
                                </div>
                                <div class="col-sm-6 col-xs-6">
                                    <a href="productPage.html">
                                        <img class="img-responsive img-hover img-product" src="img/products/artprint.jpg" alt="art print">
                                    </a>
                                </div>
                                <div class="col-sm-6 col-xs-6">
                                    <a href="productPage.html">
                                        <img class="img-responsive img-hover img-product" src="img/products/framedart.png" alt="framed print">
                                    </a>
                                </div>
                                <div class="col-sm-6 col-xs-6">
                                    <a href="productPage.html">
                                        <img class="img-responsive img-hover img-product" src="img/products/canvas.jpg" alt="canvas print">
                                    </a>
                                </div>
                                <div class="col-sm-6 col-xs-6">
                                    <a href="productPage.html">
                                        <img class="img-responsive img-hover img-product" src="img/products/metal.jpg" alt="metal print">
                                    </a>
                                </div>

                            </div> <!-- /.row -->

                            <!-- Cases Row -->
                            <div class="row">
                                <div class="col-lg-12">
                                    <h3 class="page-header">Cases</h3>
                                </div>

                                <div class="col-sm-6 col-xs-6">
                                    <a href="productPage.html">
                                        <img class="img-responsive img-hover img-product" src="img/products/iphonecase.jpg" alt="iphone case">
                                    </a>
                                </div>
                                <div class="col-sm-6 col-xs-6">
                                    <a href="productPage.html">
                                        <img class="img-responsive img-hover img-product" src="img/products/samsungcase.jpg" alt="samsung case">
                                    </a>
                                </div>
                                <div class="col-sm-6 col-xs-6">
                                    <a href="productPage.html">
                                        <img class="img-responsive img-hover img-product" src="img/products/ipadcase.jpg" alt="ipad case">
                                    </a>
                                </div>
                                <div class="col-sm-6 col-xs-6">
                                    <a href="productPage.html">
                                        <img class="img-responsive img-hover img-product" src="img/products/laptopskin.jpg" alt="laptop skin">
                                    </a>
                                </div>
                            </div> <!-- /.row -->

                            <!-- Clothing Row -->
                            <div class="row">
                                <div class="col-lg-12">
                                    <h3 class="page-header">Stationery</h3>
                                </div>

                                <div class="col-sm-6 col-xs-6">
                                    <a href="productPage.html">
                                        <img class="img-responsive img-hover img-product" src="img/products/sticker.png" alt="sticker">
                                    </a>
                                </div>
                                <div class="col-sm-6 col-xs-6">
                                    <a href="productPage.html">
                                        <img class="img-responsive img-hover img-product" src="img/products/notebook.jpg" alt="notebook">
                                    </a>
                                </div>
                                <div class="col-sm-6 col-xs-6">
                                    <a href="productPage.html">
                                        <img class="img-responsive img-hover img-product" src="img/products/hardcoverjournal.png" alt="hardcover journal">
                                    </a>
                                </div>
                            </div> <!-- /.row -->

                            <!-- Home Row -->
                            <div class="row">
                                <div class="col-lg-12">
                                    <h3 class="page-header">Home Decor</h3>
                                </div>

                                <div class="col-sm-6 col-xs-6">
                                    <a href="productPage.html">
                                        <img class="img-responsive img-hover img-product" src="img/products/cup.png" alt="cup">
                                    </a>
                                </div>
                                <div class="col-sm-6 col-xs-6">
                                    <a href="productPage.html">
                                        <img class="img-responsive img-hover img-product" src="img/products/thermo.png" alt="thermo">
                                    </a>
                                </div>
                                <div class="col-sm-6 col-xs-6">
                                    <a href="productPage.html">
                                        <img class="img-responsive img-hover img-product" src="img/products/popcornbowl.png" alt="popcorn bowl">
                                    </a>
                                </div>
                            </div> <!-- /.row -->
                        </div> <!-- tab pane -->

                        <div class="tab-pane fade" id="tab2info">
                            Related
                        </div>

                    </div> <!-- div tab-content -->
                </div> <!-- div panel-body -->
            </div> <!-- div panel -->
            </div>

            <!-- Comments -->
            <div class="col-md-6">
                <div class="well">
                    <h3 style="text-align: center"><strong>Design commments</strong></h3>
                    <hr>
                    <form role="form">
                        <div class="form-group">
                            <textarea id="commentTextarea" class="form-control" rows="5" maxlength="500" placeholder="Leave a comment"></textarea>
                        </div>
                        <button type="button" class="btn btn-danger pull-right" id="addCommentButton">Add Comment</button>
                    </form>
                    <br><hr>
                    <div id="commentsSection">

                    </div><!-- Comments section -->
                </div> <!-- well -->
            </div> <!-- col-md-6 -->
        </div> <!-- row -->

    </div> <!-- Main Container -->
</body>

<script src="js/navButtons.js"></script>
<script type="text/javascript">
    $(document).on('ready',function() {

        // Setting the action to get product info
        $.ajax({
            type: 'POST',
            url: 'data/applicationLayer.php',
            dataType: 'json',
            data: {'action':'PRODUCT'},
            headers: {'Content-Type': 'application/x-www-form-urlencoded'},
            success: function(jsonData) {
                var designImage = '<a href="#" class="thumbnail">                    <img src="img/designs/'+ jsonData.designId + '" alt="..."></a>';

                var productImage = '<a href="#" class="thumbnail">                    <img src="img/products/'+ jsonData.data[0].smallImage  + '" alt="..."></a>';

                $("#buyHeader").html(jsonData.data[0].productName);
                $("#productImage").html(designImage + productImage);
                $("#unitPriceText").children("strong").html(jsonData.unitPrice);
                $("#productTypeText").children("strong").html(jsonData.data[0].type);

                if(jsonData.data[0].type == "wall-art")
                {
                    $("#colorProduct-group").hide();
                }

                if(jsonData.data[0].type == "cases")
                {
                    $("#sizeProduct-group").hide();
                }

            },
            error: function(errorMsg){
                console.log(errorMsg);
            }
        });

        // Setting the action to get the comments made to the design
        $.ajax({
            type: 'POST',
            url: 'data/applicationLayer.php',
            dataType: 'json',
            data: {'action':'GET_COMMENT'},
            headers: {'Content-Type': 'application/x-www-form-urlencoded'},
            success: function(jsonData) {
                var commentCode = "";
                var name = "";

                for(i = 0; i < jsonData.data.length; i++) {
                    name = jsonData.data[i].fName +' '+ jsonData.data[i].lName;
                    commentCode += '<div class="media">' +
                        '<a class="pull-left" href="#">' +
                            '<img class="media-object" alt="64x64" src="img/admin/user.png"></a>' +
                        '<div class="media-body">' +
                            '<h5 class="media-heading"><strong>' + name + '</strong></h5>' + jsonData.data[i].comment + '</div></div>';
                }

                $("#commentsSection").html(commentCode);
            },
            error: function(errorMsg){
                console.log(errorMsg.statusText);
            }
        });

        $('#addToCartButton').on('click', function(){
            var jsonObject = {'action':'ADD_CART',
                    "quantity": $("#quantityProduct").val()};

            if($("#productTypeText").text() == "wall-art"){
                jsonObject['size'] = $("#sizeProduct option:selected").text();
                jsonObject['color'] = "-";
            } else if($("#productTypeText").text() == "cases"){
                jsonObject['size'] = "-";
                jsonObject['color'] = $("input[name=colorProduct]:checked").val();
            } else {
                jsonObject['size'] = $("#sizeProduct option:selected").text();
                jsonObject['color'] = $("input[name=colorProduct]:checked").val();
            }

            console.log(jsonObject);

            $.ajax({
                type: 'POST',
                url: 'data/applicationLayer.php',
                dataType: 'json',
                data: jsonObject,
                headers: {'Content-Type': 'application/x-www-form-urlencoded'},
                success: function(jsonData) {
                    alert("Your product has been added to the cart");
                    window.location.reload();
                },
                error: function(errorMsg){
                    console.log(errorMsg);
                }
            });
        });

        // Setting the action to add a comment to the design
        $('#addCommentButton').on('click', function(){
            var comment = $("#commentTextarea").val();
            var commentCode = "";

            $.ajax({
                type: 'POST',
                url: 'data/applicationLayer.php',
                dataType: 'json',
                data: {'action':'COMMENT', 'comment':comment},
                headers: {'Content-Type': 'application/x-www-form-urlencoded'},
                success: function(jsonData) {
                    var name = jsonData.firstName +' '+ jsonData.lastName;

                    commentCode = '<div class="media">' +
                        '<a class="pull-left" href="#">' +
                            '<img class="media-object" alt="64x64" src="img/admin/user.png"></a>' +
                        '<div class="media-body">' +
                            '<h5 class="media-heading"><strong>' + name + '</strong></h5>' + comment + '</div></div>';

                    $("#commentsSection").prepend(commentCode);
                    $("#commentTextarea").val("");
                },
                error: function(errorMsg){
                    alert("You need to be logged to comment!");
                }
            });
        });

        // Setting the action for choosing a product
        $("#tab1info").on('click','a',function(){
            var productName = $(this).children("img").attr("alt");

            $.ajax({
                type: 'POST',
                url: 'data/applicationLayer.php',
                dataType: 'json',
                data: {'action':'SET_PRODUCT', 'productName':productName},
                headers: {'Content-Type': 'application/x-www-form-urlencoded'},
                success: function(jsonData) {
                    console.log(jsonData);
                },
                error: function(errorMsg){
                    console.log(errorMsg.statusText);
                }
            });
        });



    });
</script>

</html>
